Work in progress.

Boundary cases need to be tested.